<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A trait used to implement the raw communication with the X11 server."><meta name="keywords" content="rust, rustlang, rust-lang, Stream"><title>Stream in x11rb::rust_connection - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../main.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../x11rb/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../x11rb/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Stream</a></h2><div class="sidebar-elems"><section><div class="block"><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><ul><li><a href="#tymethod.poll">poll</a></li><li><a href="#tymethod.read">read</a></li><li><a href="#tymethod.write">write</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#provided-methods">Provided Methods</a></h3><ul><li><a href="#method.read_exact">read_exact</a></li><li><a href="#method.write_vectored">write_vectored</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div></section><h2 class="location"><a href="index.html">In x11rb::rust_connection</a></h2></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../x11rb/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><div id="settings-menu" tabindex="-1">
                                <a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Trait <a href="../index.html">x11rb</a>::<wbr><a href="index.html">rust_connection</a>::<wbr><a class="trait" href="#">Stream</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/x11rb/rust_connection/stream.rs.html#48-170">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust trait"><code>pub trait Stream {
    fn <a href="#tymethod.poll" class="fnname">poll</a>(&amp;self, mode: <a class="enum" href="enum.PollMode.html" title="enum x11rb::rust_connection::PollMode">PollMode</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.read" class="fnname">read</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf: &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.u8.html">u8</a>], <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fd_storage: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.63.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.usize.html">usize</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.write" class="fnname">write</a>(&amp;self, buf: &amp;[<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.u8.html">u8</a>], fds: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.63.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.usize.html">usize</a>&gt;;

    fn <a href="#method.read_exact" class="fnname">read_exact</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf: &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.u8.html">u8</a>], <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fd_storage: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.63.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.unit.html">()</a>&gt; { ... }
<span class="item-spacer"></span>    fn <a href="#method.write_vectored" class="fnname">write_vectored</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bufs: &amp;[<a class="struct" href="https://doc.rust-lang.org/1.63.0/std/io/struct.IoSlice.html" title="struct std::io::IoSlice">IoSlice</a>&lt;'_&gt;], <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fds: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.63.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.usize.html">usize</a>&gt; { ... }
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A trait used to implement the raw communication with the X11 server.</p>
<p>None of the functions of this trait shall return <a href="https://doc.rust-lang.org/1.63.0/std/io/error/enum.ErrorKind.html#variant.Interrupted" title="std::io::ErrorKind::Interrupted"><code>std::io::ErrorKind::Interrupted</code></a>.
If a system call fails with this error, the implementation should try again.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="tymethod.poll" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/x11rb/rust_connection/stream.rs.html#64">source</a></div><h4 class="code-header">fn <a href="#tymethod.poll" class="fnname">poll</a>(&amp;self, mode: <a class="enum" href="enum.PollMode.html" title="enum x11rb::rust_connection::PollMode">PollMode</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.unit.html">()</a>&gt;</h4></div></summary><div class="docblock"><p>Waits for level-triggered read and/or write events on the stream.</p>
<p>This function does not return what caused it to complete the poll.
Instead, callers should try to read or write and check for
<a href="https://doc.rust-lang.org/1.63.0/std/io/error/enum.ErrorKind.html#variant.WouldBlock" title="std::io::ErrorKind::WouldBlock"><code>std::io::ErrorKind::WouldBlock</code></a>.</p>
<p>This function is allowed to spuriously return even if the stream
is neither readable nor writable. However, it shall not do it
continuously, which would cause a 100% CPU usage.</p>
<h5 id="multithreading"><a href="#multithreading">Multithreading</a></h5>
<p>If <code>Self</code> is <code>Send + Sync</code> and <code>poll</code> is used concurrently from more than
one thread, all threads should wake when the stream becomes readable (when
<code>read</code> is <code>true</code>) or writable (when <code>write</code> is <code>true</code>).</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.read" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/x11rb/rust_connection/stream.rs.html#87">source</a></div><h4 class="code-header">fn <a href="#tymethod.read" class="fnname">read</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;buf: &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.u8.html">u8</a>], <br>&nbsp;&nbsp;&nbsp;&nbsp;fd_storage: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.63.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;<br>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.usize.html">usize</a>&gt;</h4></div></summary><div class="docblock"><p>Read some bytes and FDs from this reader without blocking, returning how many bytes
were read.</p>
<p>This function works like <a href="https://doc.rust-lang.org/1.63.0/std/io/trait.Read.html#tymethod.read" title="std::io::Read::read"><code>std::io::Read::read</code></a>, but also supports the reception of file
descriptors. Any received file descriptors are appended to the given <code>fd_storage</code>.
Whereas implementation of <a href="https://doc.rust-lang.org/1.63.0/std/io/trait.Read.html#tymethod.read" title="std::io::Read::read"><code>std::io::Read::read</code></a> are allowed to block or not to block,
this method shall never block and return <code>ErrorKind::WouldBlock</code> if needed.</p>
<p>This function does not guarantee that all file descriptors were sent together with the data
with which they are received. However, file descriptors may not be received later than the
data that was sent at the same time. Instead, file descriptors may only be received
earlier.</p>
<h5 id="multithreading-1"><a href="#multithreading-1">Multithreading</a></h5>
<p>If <code>Self</code> is <code>Send + Sync</code> and <code>read</code> is used concurrently from more than one thread:</p>
<ul>
<li>Both the data and the file descriptors shall be read in order, but possibly
interleaved across threads.</li>
<li>Neither the data nor the file descriptors shall be duplicated.</li>
<li>The returned value shall always be the actual number of bytes read into <code>buf</code>.</li>
</ul>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.write" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/x11rb/rust_connection/stream.rs.html#150">source</a></div><h4 class="code-header">fn <a href="#tymethod.write" class="fnname">write</a>(&amp;self, buf: &amp;[<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.u8.html">u8</a>], fds: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.63.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.usize.html">usize</a>&gt;</h4></div></summary><div class="docblock"><p>Write a buffer and some FDs into this writer without blocking, returning how many
bytes were written.</p>
<p>This function works like <a href="https://doc.rust-lang.org/1.63.0/std/io/trait.Write.html#tymethod.write" title="std::io::Write::write"><code>std::io::Write::write</code></a>, but also supports sending file
descriptors. The <code>fds</code> argument contains the file descriptors to send. The order of file
descriptors is maintained. Whereas implementation of <a href="https://doc.rust-lang.org/1.63.0/std/io/trait.Write.html#tymethod.write" title="std::io::Write::write"><code>std::io::Write::write</code></a> are
allowed to block or not to block, this function must never block and return
<code>ErrorKind::WouldBlock</code> if needed.</p>
<p>This function does not guarantee that all file descriptors are sent together with the data.
Any file descriptors that were sent are removed from the beginning of the given <code>Vec</code>.</p>
<p>There is no guarantee that the given file descriptors are received together with the given
data. File descriptors might be received earlier than their corresponding data. It is not
allowed for file descriptors to be received later than the bytes that were sent at the same
time.</p>
<h5 id="multithreading-2"><a href="#multithreading-2">Multithreading</a></h5>
<p>If <code>Self</code> is <code>Send + Sync</code> and <code>write</code> is used concurrently from more than one thread:</p>
<ul>
<li>Both the data and the file descriptors shall be written in order, but possibly
interleaved across threads.</li>
<li>Neither the data nor the file descriptors shall be duplicated.</li>
<li>The returned value shall always be the actual number of bytes written from <code>buf</code>.</li>
</ul>
</div></details></div><h2 id="provided-methods" class="small-section-header">Provided Methods<a href="#provided-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="method.read_exact" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/x11rb/rust_connection/stream.rs.html#106-123">source</a></div><h4 class="code-header">fn <a href="#method.read_exact" class="fnname">read_exact</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;buf: &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.u8.html">u8</a>], <br>&nbsp;&nbsp;&nbsp;&nbsp;fd_storage: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.63.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;<br>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.unit.html">()</a>&gt;</h4></div></summary><div class="docblock"><p>Read the exact number of bytes required to fill <code>buf</code> and also some amount of FDs.</p>
<p>Unlike <code>read</code>, this method always blocks until <code>buf</code> has been filled or there is an
error.</p>
<p>This function works like <a href="https://doc.rust-lang.org/1.63.0/std/io/trait.Read.html#tymethod.read" title="std::io::Read::read"><code>std::io::Read::read</code></a>, but also supports the reception of file
descriptors. Any received file descriptors are appended to the given <code>fd_storage</code>.</p>
<p>This function does not guarantee that all file descriptors were sent together with the data
with which they are received. However, file descriptors may not be received later than the
data that was sent at the same time. Instead, file descriptors may only be received
earlier.</p>
<h5 id="multithreading-3"><a href="#multithreading-3">Multithreading</a></h5>
<p>Same as <code>read</code>. In any case, if this function returns without error, <code>buf.len()</code> bytes
should have been read into <code>buf</code>.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.write_vectored" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/x11rb/rust_connection/stream.rs.html#162-169">source</a></div><h4 class="code-header">fn <a href="#method.write_vectored" class="fnname">write_vectored</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;bufs: &amp;[<a class="struct" href="https://doc.rust-lang.org/1.63.0/std/io/struct.IoSlice.html" title="struct std::io::IoSlice">IoSlice</a>&lt;'_&gt;], <br>&nbsp;&nbsp;&nbsp;&nbsp;fds: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.63.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;<br>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.63.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.63.0/std/primitive.usize.html">usize</a>&gt;</h4></div></summary><div class="docblock"><p>Like <code>write</code>, except that it writes from a slice of buffers. Like <code>write</code>, this
method must never block.</p>
<p>This method must behave as a call to <code>write</code> with the buffers concatenated would.</p>
<p>The default implementation calls <code>write</code> with the first nonempty buffer provided.</p>
<h5 id="multithreading-4"><a href="#multithreading-4">Multithreading</a></h5>
<p>Same as <code>write</code>.</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><section id="impl-Stream" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../../src/x11rb/rust_connection/stream.rs.html#378-542">source</a></span><a href="#impl-Stream" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="trait.Stream.html" title="trait x11rb::rust_connection::Stream">Stream</a> for <a class="struct" href="struct.DefaultStream.html" title="struct x11rb::rust_connection::DefaultStream">DefaultStream</a></h3></section></div><script type="text/javascript" src="../../implementors/x11rb/rust_connection/stream/trait.Stream.js" data-ignore-extern-crates="" async></script></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="x11rb" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.63.0 (4b91a6ea7 2022-08-08)" ></div>
</body></html>